# 网关和认证中心、数据中心网关和数据中心更新说明

---
关键词标签`新增`，`修复`，`变更`，`优化`，`即将删除`，`删除`

[历史版本下载](http://10.10.204.156:8001/自研软件/中间件)

&nbsp;

## v2.1.2.1(2023-10-26)

+ 1、`新增`新增了对接第三方系统登录（三藏） 

  2、`新增`新增了行政区域表的字段（is_use：是否使用，ranks：排序）

  3、`新增`新增了行政区域类型表的字段（level：区域级别）

  4、`新增`新增了一个清理缓存接口

  5、`新增`新增了获取技术支持和建设单位接口

  6、`新增`新增了基于oauth2.0协议处理登录集成方法

  7、`新增`新增了基于oauth集成登出方式
  
  8、`修复`修复了通过服务内部调用获取当前用户接口的用户信息加密密文有+号时还原解析会变成空格问题

  9、`修复`修复了APP端调用忘记密码接口修改密码报错问题

  10、`修复`修复了用户注册时设置角色报错导致角色设置不成功问题

  11、`修复`修复了表单提交时接收不到数据问题

  12、`修复`修复了数据中心接口监控相关bug

  13、`变更`修改了公共的数据是否存在查询方法

  14、`变更`修改了SM4加密方式，配合.net的SM4加密方式使用PKCS7Padding填充方式

  15、`变更`修改了行政区域数据返回属性，新增了父级行政区域类型

  16、`变更`修改了图片上传获取的根目录路径方式

  17、`变更`修改了用户授权方法，提取处理成工具类

  18、`变更`修改了获取集成url方法迁移到指定的controller

  19、`变更`修改了Jackson的版本，升级到2.14.2

  20、`变更`修改了手机号码的正则匹配规则

  21、`变更`修改了平台登出方法

  22、`变更`修改了oauth2.0方式获取授权码时用户校验方式

  23、`优化`优化了平台集成方式

  24、`即将删除`即将删除 接口通过账户获取token（接口地址为/api/auth/token/get）

  25、`即将删除`即将删除 接口通过账户获取链接（接口地址为/api/auth/token/url）

  26、`删除`删除了用户列表左侧单位信息通过缓存获取功能

&nbsp;

## v2.1.2.0【正式版】(2023-08-02)

+ 1、`新增`新增对MySQL、Redis、Nacos、Ftp配置敏感信息进行加密解析的处理功能

  2、`变更`修改了中间件内部程序包的配置文件的敏感信息，可删除的全部删除，不可删除的全部进行加密处理

&nbsp;

## v2.1.1.0【正式版】(2023-07-07)

**特别说明**

当前版本越权处理修改的地方比较多，虽然框架已经提测通过，但是业务更新后可能会存在兼容问题，

因此更新后都要测试一下才能部署上线，不要直接部署上线，具体注意事项请看 `自研软件资产 -> 中间件部署指南 -> 部署注意事项` 这篇文章

+ 1、`新增`新增了用户导入功能和单位导入功能

  2、`新增`新增了通过角色ID或者编码查询用户信息接口

  3、`修复`修复了接口垂直越权访问和水平越权访问等相关问题

  4、`修复`修复了修改密码页面不需签名也能正常访问问题

  5、`变更`修改了配置文件，开启SQL自动检测功能

  5、`变更`修改了用户管理列表请求方式

&nbsp;

## v2.1.0.1(2023-05-24)

+ 1、`新增`新增用户推送到指定系统的功能

  2、`新增`新增了应用管理隐藏功能

  3、`删除`去掉isEncry密码是否加密判断，登录的密码都是经过加密的密文

&nbsp;

## v2.1.0.0(2023-05-11)【正式版】

+ 1、`新增`新增了第三方系统调用的退出登录功能

  2、`修复`修复了因redis通道相同导致不同项目链接相同redis时，每个系统的日志信息推送到所有系统上

  3、`变更`修改了登录时日志记录的用户名

&nbsp;

## v2.0.2.4(2023-04-24)【重要更新】

+ 1、`新增`新增了登录接口用户名加密传输功能

  2、`新增`新增了菜单管理自定义页面路径字段

  3、`新增`新增了通过oauth协议同步客户端信息接口

  4、`新增`新增了一个oauth2.0协议获取授权码的接口

  5、`新增`新增了操作FTP服务工具类，提供了上传，下载，查看图片方法

  6、`新增`新增了省授权平台生成的token进行登录接口（未完成）

  7、`变更`修改了oauth2.0协议密码模式获取授权的处理方式

  8、`变更`修改了获取当前菜单根据菜单访问地址（url）字段进行去重处理

  9、`变更`修改了oauth2.0协议的单点登录方式

  10、`变更`修改了获取当前菜单接口，返回接入类型是单点登录但菜单为空的应用信息

  11、`变更`修改了上传、下载、查看图片相关接口

  12、`修复`修复了前端的必填项绕过前端为空新增/编辑成功问题

  13、`修复`修复了不符合邮箱和手机格式，新增和编辑成功问题

  14、`修复`修复了用户编辑为已存在的账户成功。造成登录账号相同问题

  15、`修复`修复了密码失效修改密码时报错的问题

  16、`修复`修复了字典工具类初始化是数据为空报错的问题

  17、`修复`修复了身份证校验错误问题

  18、`修复`修复了oauth登录接收账号密码带有+号会转义成空格

  19、`修复`修复了数字类型校验空报错问题

  20、`修复`修复了oauth跳转登录页时登录页找不到问题

  21、`修复`修改了当应用菜单为空时系统选择页不显示系统问题

  22、`优化`优化了页面列表为空时数据展示

  23、`优化`优化了登录模块的代码

  24、`优化`优化了菜单新增修改校验访问地址（url）是否存在判断

  25、`优化`优化了所有实体必填的字段的判断

&nbsp;

## v2.0.2.3(2023-03-21)【重要更新】

+ 1、`新增`redis操作类新增了删除全部key的接口

  2、`新增`菜单信息新增了接入类型和自定义系统编码字段

  3、`修复`修复了初始化密码修改页面报原始密码不正确问题

  4、`修复`修复了接口获取用户还原手机号和身份证号错误的问题

  5、`修复`修复了操作日志记录的源ip不是客户端ip问题

  6、`修复`修复了请求头syscode值不正确其他接口均能正常访问

  7、`修复`修复了数据中心合同搜索条件不生效问题

  8、`修复`修复了初始密码修改成功后不跳转到登录页问题

  9、`优化`优化了登录接口用户冻结了提示信息

  10、`优化`优化了用户邮箱脱敏处理
  
  11、`优化`优化了网关请求处理并发量

&nbsp;

## v2.0.2.2(2023-02-14)

+ 1、`修复`修复了jwt推送用户新增接口报错问题
  
  2、`修复`修复了参数防篡改拦截器没传签名报错问题

&nbsp;

## v2.0.2.1(2023-01-31)

+ 1、`新增`行政区域新增行政区划的代表中心点位置坐标

&nbsp;

## v2.0.2.0(2023-01-29)【重要更新】

+ 1、`新增`添加了第三方同步平台用户接口

  2、`新增`对接公司短信接口，新增短信发送功能

  3、`新增`添加了双因素登录功能

  4、`新增`添加了短信发送日志记录功能

  5、`变更`修改了熔断返回方法

  6、`变更`修改了附件删除同时删除实体文件策略，修改后不删除实体文件

  7、`变更`修改了数据中心请求接口，添加数组参数处理

  8、`修复`修复了多用户分配多角色时，如果其中一个角色不分配按钮权限导致其他角色分配的按钮权限都失效问题

  9、`修复`修复了路由访问为空报错问题

  10、`修复`修复普通用户在分配多个角色时，菜单页面会有多个应用系统的问题

  11、`修复`修复了修改密码时，接口旧密码为空后也可以正常修改密码的漏洞

&nbsp;

## v2.0.1.0(2022-10-28)【重要更新】

+ 1、`新增`应用管理添加了排序字段
  
  2、`新增`新增了邮箱登录方法
  
  3、`新增`新增获取jwt token 的方法
  
  4、`新增`添加了请求参数防篡改功能
  
  5、`新增`添加了邮箱登录方式
  
  6、`新增`添加SM2、SM3和SM4加密功能
  
  7、`新增`网关新增动态请求源ip配置
  
  8、`变更`修改应用管理查询方法按照排序查询
  
  9、`变更`修改了密码加密方式为DES(兼容旧的base64加解密)
  
  10、`变更`修改了登录强密码校验和文件管理的数据权限

  11、`修复`修复了获取当前用户菜单请求慢问题
  
  12、`修复`修复了注册接口用户手机加密方法错误
  
  13、`修复`修复了低权限账号可访问高权限账号的资源

  14、`修复`修复了角色权限设置页面在菜单设置不启用时还能查询回来问题

  15、`修复`修复了应用配置了指定url，但角色未配置该url，登录报404问题

&nbsp;

## v2.0.0.2(2022-07-18)

+ 1、`修复`修复了跨域资源共享问题

&nbsp;

## v2.0.0.1(2022-07-12)

+ 1、`新增`数据中心的合同管理添加了合同编号查询条件

  2、`修复`修复了Tomcat漏洞，漏洞编号为CVE-2022-29885

&nbsp;

## v2.0.0.0 (2022-06-20)

+ 1、`新增`添加用户名是否敏感校验的功能

  2、`新增`完成iframe嵌套的相关开发

  3、`变更`修改了弱口令密码不能登录

  4、`修复`logback的漏洞问题，升级logback的版本到1.2.10
